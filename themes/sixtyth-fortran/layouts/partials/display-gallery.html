{{- /* layouts/partials/display-gallery.html
     Renders a gallery for the current page using prebuilt data.
     Each item in $photos is a plain map (not a Hugo Page).
*/ -}}

{{- $photos := partial "get-photos-from-data.html" . -}}
{{- if gt (len $photos) 0 -}}

  {{- /* dedupe by name just in case */ -}}
  {{- $seen := dict -}}
  {{- $uniq := slice -}}
  {{- range $i, $p := $photos -}}
    {{- $name := index $p "name" | default "" -}}
    {{- if and (ne $name "") (not (index $seen $name)) -}}
      {{- $seen = merge $seen (dict $name true) -}}
      {{- $uniq = $uniq | append $p -}}
    {{- end -}}
  {{- end -}}

  {{- /* Already sorted by startDate by the prebuild script â€” but if not, you can sort here. */ -}}

  <div class="gallery">
    {{- range $i, $m := $uniq -}}
      <div class="gallery-image-box">
        {{- /* pass the canonical photo name string to your DisplayPhoto partial */ -}}
        {{- $name := index $m "name" -}}
        {{- partialCached "DisplayPhoto.html" (dict "name" $name "mode" "no-css-file-link") (printf "DisplayPhoto|%s|no-css-file-link" $name) -}}
      </div>
    {{- end -}}
  </div>
{{- end -}}
