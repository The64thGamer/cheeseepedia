{{- $gallery := partial "display-gallery.html" . -}}
{{- $videos := partial "display-video-gallery.html" . -}}
{{- $transcriptions := partial "display-transcriptions.html" . -}}
{{- $reviews := partial "display-reviews.html" . -}}
{{- $article := false -}}
{{- if or (ne $gallery "") (ne $videos "") (ne $transcriptions "") -}}
  {{- $article = true -}}
{{- end -}}

{{- partial "display-breadcrumbs.html" . -}}
<h1 data-pagefind-weight="10">{{- .Title | safeHTML -}}</h1>
<div class="article-topBar">
  {{- if $article -}}
    <button class="article-button" data-target="section-article">Article</button>
  {{- end -}}
  {{- if ne $gallery "" -}}
    <button class="article-button" data-target="section-gallery">Gallery</button>
  {{- end -}}
  {{- if ne $videos "" -}}
    <button class="article-button" data-target="section-videos">Videos</button>
  {{- end -}}
  {{- if ne $transcriptions "" -}}
  <button class="article-button" data-target="section-transcriptions">Transcriptions</button>
  {{- end -}}
  {{- if ne $reviews "" -}}
  <button class="article-button" data-target="section-reviews">Reviews</button>
  {{- end -}}
  {{- partial "editButton.html" . -}}
</div>

<div id="section-article" class="article-section">
  {{- if .Params.pageThumbnailFile -}}
    <div class="article-store-thumbnail">
      {{- $thumb := default "" .Params.pageThumbnailFile -}}
      {{- $mode := "raw-photo" -}}
      {{- partialCached "DisplayPhoto.html" (dict "name" $thumb "mode" $mode) (printf "%s|%s" $thumb $mode) -}}
    </div>
  {{- end -}}
  {{- partial "display-infobox-location.html" . -}}
  {{- .Content | safeHTML -}}
  {{- with .Params.animatronics }}
    <h2>Animatronics</h2>
    <table>
      <thead>
        <tr>
          <th>Character</th>
          <th>Operation</th>
          <th>Serial</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        {{- range . }}
          {{- $parts := split . "|" -}}
          {{- $name := index $parts 0 -}}
          {{- $start := index $parts 1 -}} 
          {{- $end := index $parts 2 -}} 
          {{- $serial := index $parts 3 -}}
          {{- $status := index $parts 4 -}}
          <tr>
            <td>{{ partial "wiki-link.html" (dict "name" $name "context" $) }}</td>
            <td>{{- partial "Readable_Date.html" (dict "date" $start "presentOnEmpty" false) -}}{{- " - " -}}{{- partial "Readable_Date.html" (dict "date" $end "presentOnEmpty" true) -}}</td>
            <td>{{ $serial }}</td>
            <td>{{ $status }}</td>
          </tr>
        {{- end }}
      </tbody>
    </table>
  {{- end }}
  {{- with .Params.attractions }}
    <h2>Attractions</h2>
    <table>
      <thead>
        <tr>
          <th>Attraction</th>
          <th>Operation</th>
          <th>Notes</th>
        </tr>
      </thead>
      <tbody>
        {{- range . }}
          {{- $parts := split . "|" -}}
          {{- $name := index $parts 0 -}}
          {{- $start := index $parts 1 -}}
          {{- $end := index $parts 2 -}}
          {{- $notes := index $parts 3 -}}
          <tr>
              <td>{{ partial "wiki-link.html" (dict "name" $name "context" $) }}</td>
              <td>{{- partial "Readable_Date.html" (dict "date" $start "presentOnEmpty" false) -}}{{- " - " -}}{{- partial "Readable_Date.html" (dict "date" $end "presentOnEmpty" true) -}}</td>
              <td>{{ $notes }}</td>
          </tr>
        {{- end }}
      </tbody>
    </table>
  {{- end }}
</div>
{{- if ne $gallery "" -}}
  <div id="section-gallery" class="article-section">
    {{- $gallery -}}
  </div>
{{- end -}}
<div id="section-videos" class="article-section">
  {{- if ne $videos "" -}}
    {{- $videos -}}
  {{- end -}}
</div>
<div id="section-transcriptions" class="article-section">
  {{- if ne $transcriptions "" -}}
    {{- $transcriptions -}}
  {{- end -}}
</div>
<div id="section-reviews" class="article-section">
  {{- if ne $reviews "" -}}
    {{- $reviews -}}
  {{- end -}}
</div>
<hr>
{{- partial "display-citations.html" . -}}
{{- partial "display-contributors.html" . -}}
{{- partial "Random_Page.html" . -}}

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Hide all sections
    const sections = document.querySelectorAll('.article-section');
    sections.forEach(section => section.style.display = 'none');

    // Show the default section (Article)
    const defaultSection = document.getElementById('section-article');
    defaultSection.style.display = 'inline-block';

    // Add event listeners to buttons
    const buttons = document.querySelectorAll('.article-button');
    buttons.forEach(button => {
      button.addEventListener('click', function() {
        // Hide all sections
        sections.forEach(section => section.style.display = 'none');

        // Show the clicked section
        const targetSection = document.getElementById(this.dataset.target);
        if (targetSection) {
          targetSection.style.display = 'inline-block';
        }
      });
    });
  });
</script>